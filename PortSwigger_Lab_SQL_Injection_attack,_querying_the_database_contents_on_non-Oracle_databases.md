# SQL Injection attack, querying database contents on non-Oracle Database
This time I decided to check on PortSwigger lab to play around and stumble upon this lab.
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/ja5SjdSY03BYpAjOZyLFJiSeXA6t_sZS2GsnibYJJmo=.png)
The main gimmick of the lab is that there is a SQL injection (SQLi) in the product category filter that you can use to query the database content. And with those query, we should be able to get the `administrator` user. 
## Initial webpage access
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/lI2jSBGAL3TpmikAePVlzc3iQppdzKu_JmiN-Ntf_3M=.png)
When first opening the webpage, we were greeted with a list of item with a description about it. There is multiple things that we check around. Firstly, there is a my account page that seems to bring us to a login page. It looks like that is the place where we will be using the `administrator` credentials that we got later. Let's check around the other available place that we could go. It seems that on the item lists, there is a way to refine the item list. Let's check what happen when we click on of the refine options.
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/ktDlA6iDhAmsH1AUXuXMypS-OBQLL_t3jGsda6Ya4jM=.png)
So there is a filter that request a category from the user, It could be a way for us to get the administration credentials from. Of course, first thing to do is to check whether it is possible for us to even do SQLi on it. I will be using caido replay feature to modify the request.
## Chains of SQLi for the credential
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/EcyMz5SLB1TLuYwRZmZc3n40z3BurMyXKAsQNlWi1RM=.png)
Scrolling down a bit on the response, you could see the same list as when you click it on the website itself. Let's try to use UNION to write add a new SELECT statement into the SQL request.
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/QMCzJ4KDWmEGBQoEMs9OzHZxUN4fp7cysqz2v0oAFI8=.png)
As you could see,by using `'+UNION+SELECT+'abc',+'def'+--+;` as the payload, the SQLi works with UNION based injection from the response of 'abc' and 'def'. The first thing we need to do is to find the name of the table that holds the credential for the `administrator`. From the question, we know that the  Based on the documentation of MySQL, we could there is a special table on MySQL that have metadata of the database itself named INFORMATION_SCHEMA. and the list of tables available on there, there is a one table that intrigue me to check, which is `TABLES` table. It contains information about the tables in databases. The main two columns that I will be checking are these;
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/LSOXmJuZc2DRpZcDugi4sb9rCfpEGiVRaCwn8CwU8ik=.png)
So i inquire the website for it by using `'+UNION+SELECT+TABLE_SCHEMA+TABLE_NAME+FROM+INFORMATION_SCHEMA.TABLES+--+;` as the payload to list all the available tables in the database.
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/8kIpwoK-EQV8Pw49pDKl5BKILOdZGQuVPHu07Vqmbrw=.png)
Nice, the `users_ysfpyp` should be the table that holds the entirety of users credentials. However there is still a problem, how are we going to query the table without knowing the columns in the table. Since UNION based injection need the number of column to be the same with the original query, if the UNION does not have the same number of column, it will not work and nothing will be print. But there is a solution for the problem. You see, according to the documentation, there is another table on INFORMATION_SCHEMA database that we could use to get the columns of a table. It is called `COLUMNS` table. On this table, I will be using this two columns as the payload;
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/eC1qU4Ak-EOx9zj419m_niGCarj-wlqyOJyoS6Fey1A=.png)
With this, the next payload that I send to the server is `'+UNION+SELECT+COLUMN_NAME,TABLE_NAME+FROM+INFORMATION_SCHEMA.COLUMNS+where+TABLE_NAME='users_ycfpyp'+--+;`. With this the server should reply with the columns name for the table `users_ycfpyp`.
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/G5wGiIacfA5QZwv7p_1N1ma1cJgaDsPuG6qFDkggyfM=.png)
And it does! So now that we got both the table name and the columns name, we could do the last SQLi to get the `administrator` credential. By using everything that we learned before, the last payload should look like this; `'+UNION+SELECT+username_ucheza,password_rixdhe+from+public.users_ycfpyp+--+;`  and after sending it to the server....
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/SSNVhKnUiXuJ8deNnD2BG2c0fOG7HABU9EUs6nrWKWQ=.png)
That's it! we finally got the password for` administrator`, which is` a3ai08lfftkbw9cfxh98`. We can use this to login as `administrator` and finish the lab.
![](https://beta.appflowy.cloud/api/file_storage/0535e7ca-62b3-4f1c-b53c-bb4dd6534174/v1/blob/00c8b8bd%2D2b10%2D4549%2D9ea8%2Dfa14facf3a4f/5lyZ0qVKlChGpwazTeKAzh4z5e1be_Xi3jjhOamsZxw=.png)
And the lab is now solved. This lab teaches a lot about basic UNION based injection and how you could use the INFORMATION_SCHEME to gain a lot of information about the tables in the entire database itself. 
